package app.userpermit\r\n\r\nimport future.keywords.if\r\nimport future.keywords.in\r\n\r\ndefault allow := true\r\n\r\ndefault any_invalid_tre := false\r\n\r\ndefault any_valid_users := true\r\n\r\ndefault project_allow := true\r\n\r\ndefault any_is_user_allowed := true\r\n\r\ndefault any_is_tre_data_valid := true\r\n\r\nallow if {\r\n\tis_tre_data_valid(input.treData)\r\n\tis_user_allowed(input.userName)\r\n}\r\n\r\nis_tre_data_valid(treData) if {\r\n\ttreData != null\r\n\tcount(treData) > 0\r\n}\r\n\r\nis_user_allowed(userName) if {\r\n\tuserName != null\r\n\tcount(userName) > 0\r\n}\r\n\r\nproject_allow if {\r\n\tany_is_tre_data_valid\r\n\tany_is_user_allowed\r\n}\r\n
         