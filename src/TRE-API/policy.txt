package app.checkaccess

import future.keywords.if
import future.keywords.in

default allow := false

default any_invalid_tre := false

default any_valid_users := true

default project_allow := false

default any_is_user_allowed := false

default any_is_tre_data_valid := false

allow if {
	is_tre_data_valid(input.treData)
	is_user_allowed(input.userName)
}

is_tre_data_valid(treData) if {
	treData != null
	count(treData) > 0
}

is_user_allowed(userName) if {
	userName != null
	count(userName) > 0
}

project_allow if {
	any_is_tre_data_valid
	any_is_user_allowed
}
