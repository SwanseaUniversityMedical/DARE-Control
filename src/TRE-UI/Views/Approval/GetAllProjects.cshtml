@using BL.Models.Enums
@model List<BL.Models.TreProject>
@{
    ViewData["Title"] = "Projects";
    var projectsCount = Model.Count;
    var showOnlyUnprocessed = ViewBag.ShowOnlyUnprocessed ?? false;
    var unprocessedProjects = Model.Where(p => p.Decision == Decision.Undecided).ToList();
}

<div class="container-lg p-4">
    <div class="d-flex align-items-center justify-content-between">
        <h1 class="fs-3 mb-0">Projects</h1>
    </div>
    
    <ul class="nav nav-underline border-bottom my-4 projects-menu" id="projectTab" role="tablist">
        <li class="nav-item" role="presentation">
            <a href="#all-projects" class="nav-link text-dark @(!showOnlyUnprocessed ? "active" : "")" id="all-projects-tab" data-bs-toggle="tab" data-bs-target="#all-projects" role="tab" aria-controls="all-projects" aria-selected="@(!showOnlyUnprocessed)">
                All Projects
                <span class="badge bg-dark-blue rounded-pill ms-2">@Model.Count</span>
            </a>
        </li>
        <li class="nav-item" role="presentation">
            <a href="#unprocessed-projects" class="nav-link text-dark @(showOnlyUnprocessed ? "active" : "")" id="unprocessed-projects-tab" data-bs-toggle="tab" data-bs-target="#unprocessed-projects" role="tab" aria-controls="unprocessed-projects" aria-selected="@showOnlyUnprocessed">
                Unprocessed Projects
                <span class="badge bg-dark-blue rounded-pill ms-2">@unprocessedProjects.Count</span>
            </a>
        </li>
    </ul>

    <div class="tab-content" id="projectTabContent">
        <div class="tab-pane fade @(!showOnlyUnprocessed ? "show active" : "")" id="all-projects" role="tabpanel" aria-labelledby="all-projects-tab">
            @await Html.PartialAsync("_ProjectsTable", Model)
        </div>

        <div class="tab-pane fade @(showOnlyUnprocessed ? "show active" : "")" id="unprocessed-projects" role="tabpanel" aria-labelledby="unprocessed-projects-tab">
            @await Html.PartialAsync("_ProjectsTable", unprocessedProjects)
        </div>
    </div>
</div>

