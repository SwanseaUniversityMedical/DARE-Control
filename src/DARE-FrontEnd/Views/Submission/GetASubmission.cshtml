@model BL.Models.ViewModels.SubmissionInfo
@using BL.Models.ViewModels

@{
    string pageName = Model.Submission.TesName;

    ViewData["Title"] = @pageName;


}
<div class="container-lg mt-4 p-4">
    <div class="d-flex align-items-center justify-content-between mb-5">
        <div>
            <h1 class="fs-3 mb-0">@Model.Submission.TesName</h1>
            <p class="font-monospace text-muted small mb-0">Submission ID: @Model.Submission.Id</p>
            <div class="mt-3 d-flex gap-4">
                <div><i class="fa-solid fa-folder-open text-muted me-1"></i> <a href="@Url.Action("GetProject", "Project", new { id = Model.Submission.Project.Id })">@Model.Submission.Project.Name</a></div>
                <div><i class="fa-solid fa-user text-muted me-1"></i> <a href="@Url.Action("GetUser", "User", new { id = @Model.Submission.SubmittedBy.Id })">@Model.Submission.SubmittedBy.Name</a></div>
                <div><i class="fa-solid fa-calendar text-muted me-1"></i> @Model.Submission.StartTime</div>
            </div>
        </div>
        <div>
            <div class="text-end d-flex">
                <h6 class="mb-0">
                    <span class="badge bg-success rounded-pill d-inline-flex align-items-center" data-bs-toggle="tooltip" data-bs-title="Completed: @Model.Submission.EndTime">
                        <i class="fa-solid fa-circle-check fs-6 text-white me-2"></i>
                        <span>Completed</span>
                    </span>
                </h6>
                <h6 class="mb-0">
                    <span class="badge bg-danger rounded-pill d-inline-flex align-items-center" data-bs-toggle="tooltip" data-bs-title="Failed: @Model.Submission.EndTime">
                        <i class="fa-solid fa-triangle-exclamation fs-6 text-white me-2"></i>
                        <span>Failed</span>
                    </span>
                </h6>
                <h6 class="mb-0">
                    <span class="badge bg-primary rounded-pill d-inline-flex align-items-center" data-bs-toggle="tooltip" data-bs-title="Runtime: 0m">
                        <i class="fa-solid fa-circle-notch fa-spin fs-6 text-white me-2"></i>
                        <span>Running</span>
                    </span>
                </h6>
                @*@{
                    switch (Model.Submission.Status)
                    {
                        case BL.Models.Enums.StatusType.DataOutApproved:
                            <h6 class="mb-0">
                                <span class="badge bg-primary rounded-pill d-inline-flex align-items-center" data-bs-toggle="tooltip" data-bs-title="Failed: error message">
                                    <i class="fa-solid fa-circle-notch fa-spin fs-6 text-white me-2"></i>
                                    <span>@Model.Submission.Status @Model.Submission.EndTime</span>
                                </span>
                            </h6>
                            break;
                        default:
                            <h6 class="mb-0">
                                <span class="badge bg-primary rounded-pill d-inline-flex align-items-center" data-bs-toggle="tooltip" data-bs-title="Running">
                                    <i class="fa-solid fa-circle-notch fa-spin fs-6 text-white me-2"></i>
                                    <span>@Model.Submission.Status</span>
                                </span>
                            </h6>
                            <span class="small">Total Elapsed Time: @days days, @hours hours, @minutes minute</span>
                            break;
                    }
                }*@
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <div class="card-header bg-white shadow-sm border-1 p-4">
                <h5 class="mb-0">Submission Details</h5>
            </div>
            @{
                var minio = @ViewBag.minioendpoint;
            }
            <div class="bg-white shadow-sm border-1 p-4">
                <p>
                    Minio URL: <a href="http://@minio">@Model.Submission.Project.Name Buckets</a><br />
                    Submission Bucket: <a target="_blank" href="http://@minio/browser/@Model.Submission.Project.SubmissionBucket">@Html.Raw(Model.Submission.Project.SubmissionBucket)</a><br />
                    Output Bucket: <a target="_blank" href="http://@minio/browser/@Model.Submission.Project.OutputBucket" + @Model.Submission.Project.OutputBucket">@Html.Raw(Model.Submission.Project.OutputBucket)</a>
                </p>
                <div class="">
                    <button id="showJsonButton" class="btn btn-sm btn-primary">
                        <i class="fa fa-code me-1"></i>
                        <small>View Query</small>
                    </button>
                    <pre style="white-space:break-spaces;"><code class="json-viewer card card-body mt-2" id="jsonViewer" style="display:none;"></code></pre>
                </div>
            </div>
        </div>
        @{
            //var Date1 = DateTime.Now.AddDays(-3).AddHours(-2).AddMinutes(-33);
            var startTime = Model.Submission.StartTime;


            var currTime = DateTime.Now;
            var endTime = Model.Submission.EndTime;
            TimeSpan result1 = endTime.Subtract(startTime);
            int days = result1.Days;
            int hours = result1.Hours;
            int minutes = result1.Minutes;

            //var progressTimer = "Total Elapsed Time:";
            ////var lastStatusUpdate = tre.LastStatusUpdate;
            //TimeSpan result2 = currTime.Subtract(lastStatusUpdate);
            //int days1 = result2.Days;
            //int hours1 = result2.Hours;
            //int minutes1 = result2.Minutes;
            ////var endpointName = @tre.EndPoint?.Name.ToString();
            //if (endpointName == null)
            //{
            //    endpointName = "None";
            //}
            //switch (tre.Status)
            //{

            //    case BL.Models.Enums.StatusType.DataOutApproved:
            //        <h6><span class="badge bg-dark-blue rounded-pill">@tre.Status</span>End Time: @Model.EndTime</h6>
            //        break;

            //    default:
            //        <h6><span class="badge bg-dark-blue rounded-pill">@tre.Status</span> Elapsed Time: @days days, @hours hours, @minutes minutes</h6>
            //        break;
            //}
        }

        <div class="col-md-4">
            <div class="card-header bg-white shadow-sm border-1 p-4">
                <h5 class="mb-0">Timeline</h5>
            </div>
            <div class="bg-white shadow-sm border-1 p-4">
                <ul class="timeline list-unstyled mb-0">
                    <li class="position-relative">
                        <span class="position-absolute bg-grey h-100 timeline-line"></span>
                        <span class="position-relative d-inline-flex">
                            <span class="icon-wrap">
                                <i class="fa-solid fa-circle-play fs-3 text-info me-3"></i>
                            </span>
                            <span class="d-flex flex-column">
                                <span class="text-muted">
                                    Started
                                </span>
                                <span class="text-dark" data-bs-toggle="tooltip" data-bs-title="@startTime">
                                    @startTime
                                </span>
                            </span>
                        </span>
                    </li>
                    <li class="position-relative">
                        <span class="position-absolute bg-grey h-100 timeline-line"></span>
                        <span class="position-relative d-inline-flex">
                            <span class="icon-wrap">
                                <i class="fa-solid fa-circle-check fs-3 text-success me-3"></i>
                            </span>
                            <span class="d-flex flex-column">
                                <span class="text-muted">
                                    Finished
                                </span>
                                <span class="text-dark" data-bs-toggle="tooltip" data-bs-title="@endTime">
                                    @endTime
                                </span>
                            </span>
                        </span>
                    </li>
                    <li class="position-relative">
                        <span class="position-absolute bg-grey h-100 timeline-line"></span>
                        <span class="position-relative d-inline-flex">
                            <span class="icon-wrap">
                                <i class="fa-solid fa-clock fs-3 text-black-50 me-3"></i>
                            </span>
                            <span class="d-flex flex-column">
                                <span class="text-muted">
                                    Runtime
                                </span>
                                <span class="text-dark">
                                    @days days, @hours hours, @minutes minutes
                                </span>
                            </span>
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="card-header bg-white shadow-sm border-1 p-4 mt-4">
                <h5 class="mb-0">Event Log</h5>
            </div>
            <div class="bg-white shadow-sm border-1 px-4 pb-0">
                <div class="row">
                    <table class="table crosstab mb-0 table-striped-columns">
                        <thead>
                            <tr class="row">
                                <th class="col-2"></th>
                                @{
                                    foreach (var child in Model.Submission.Children)
                                    {
                                        <th class="col">@child.Tre?.Name.ToString()</th>
                                    }
                                }
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                foreach (var stage in Model.StageInfo)
                                {
                                    var stageNum = stage.stageNumber;
                                    <tr class="row">
                                        <td class="col-2">@stage.stageName @stage.stageNumber</td>
                                        @{
                                            foreach (var child in Model.Submission.Children)

                                            {
                                                //get all histroical statuses and current stat that is  listed in current stage stat


                                                var validstats = child.HistoricStatuses.Where(x => stage.statusTypeList.Contains(x.Status)).ToList();
                                                //just for testing for now
                                                // validstats.Add(new BL.Models.HistoricStatus() { Start = child.StartTime, Status = BL.Models.Enums.StatusType.Completed });

                                                //if (stage.statusTypeList.Contains(child.Status))
                                                if (stage.stagesDict.ContainsKey(stageNum) && stage.stageNumber == stageNum && stage.statusTypeList.Contains(child.Status))
                                                {
                                                    validstats.Add(new BL.Models.HistoricStatus() { Start = child.StartTime, Status = child.Status });
                                                    validstats = validstats.OrderBy(x => x.Start).ToList();


                                                }

                                                <td class="col">
                                                    <ul class="list-unstyled">

                                                        @foreach (var status in validstats)
                                                        {
                                                            <li>
                                                                <span data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00 Runtime: 0m">
                                                                    @status.Status
                                                                </span>
                                                            </li>

                                                        }
                                                    </ul>
                                                </td>
                                            }
                                        }
                                    </tr>
                                    //if (stage.stagesDict.ContainsKey(stageNum) && stage.stageNumber == stageNum)
                                    //{
                                    //    foreach (var key in stage.stagesDict.Keys)
                                    //    {
                                    //        foreach (var item in stage.stagesDict[key])
                                    //        {
                                    //        <td><h6>@item</h6></td>
                                    //        }
                                    //    }
                                    //}
                                }
                            }
                        </tbody>
                        <tfoot>
                            <tr class="row">
                                <td scope="col" class="col-2"></td>
                                <td scope="col" class="col">
                                </td>
                                <td scope="col" class="col">
                                </td>
                                <td scope="col" class="col">
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="card-header bg-white shadow-sm border-1 p-4 mt-4">
                <h5 class="mb-0">Event Log</h5>
            </div>
            <div class="bg-white shadow-sm border-1 px-4 pb-0">
                <div class="row">
                    <table class="table crosstab mb-0 table-striped-columns">
                        <thead>
                            <tr class="row">
                                <th scope="col" class="col-2"></th>
                                <th scope="col" class="col">DPUK</th>
                                <th scope="col" class="col">SAIL Databank</th>
                                <th scope="col" class="col">ALSPAC</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="row">
                                <td scope="col" class="col-2">Submission Validation</td>
                                <td scope="col" class="col">
                                    <ul class="timeline list-unstyled mb-0">
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Validating User
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-check-circle fs-6 text-success me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        User Validated
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Waiting For Crate Format Check
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-check-circle fs-6 text-success me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Validation Successful
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                    </ul>
                                </td>
                                <td scope="col" class="col">
                                    <ul class="timeline list-unstyled mb-0">
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Validating User
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-warning fs-6 text-danger me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Invalid User
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                    </ul>
                                </td>
                                <td scope="col" class="col">
                                    <ul class="timeline list-unstyled mb-0">
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Validating User
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-check-circle fs-6 text-success me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        User Validated
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Waiting For Crate Format Check
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-check-circle fs-6 text-success me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Validation Successful
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00 ">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                    </ul>
                                </td>
                            </tr>
                            <tr class="row">
                                <td scope="col" class="col-2">TRE Validation</td>
                                <td scope="col" class="col">
                                    <ul class="timeline list-unstyled mb-0">
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">

                                                        Waiting For Agent To Transfer To Pod
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Agent Transferring To Pod
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-check-circle fs-6 text-success me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Transferred To Pod
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                    </ul>
                                </td>
                                <td scope="col" class="col"></td>
                                <td scope="col" class="col">
                                    <ul class="timeline list-unstyled mb-0">
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">

                                                        Waiting For Agent To Transfer To Pod
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Agent Transferring To Pod
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-check-circle fs-6 text-success me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Transferred To Pod
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                    </ul>
                                </td>
                            </tr>
                            <tr class="row">
                                <td scope="col" class="col-2">Query Processing</td>
                                <td scope="col" class="col">
                                    <ul class="timeline list-unstyled mb-0">
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Pod Processing
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-check-circle fs-6 text-success me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Pod Processing Complete
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                    </ul>
                                </td>
                                <td scope="col" class="col"></td>
                                <td scope="col" class="col">
                                    <ul class="timeline list-unstyled mb-0">
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle-notch fa-spin fs-6 text-primary me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Pod Processing
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 ">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                    </ul>
                                </td>
                            </tr>
                            <tr class="row">
                                <td scope="col" class="col-2">Data Out Approval</td>
                                <td scope="col" class="col">
                                    <ul class="timeline list-unstyled mb-0">
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-circle fs-6 text-black-15 me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Data Out Approval Begun
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                        <li class="position-relative">
                                            <span class="position-absolute bg-grey h-100 timeline-line"></span>
                                            <span class="position-relative d-inline-flex">
                                                <span class="icon-wrap">
                                                    <i class="fa-solid fa-check-circle fs-6 text-success me-3"></i>
                                                </span>
                                                <span class="d-flex flex-column">
                                                    <span class="text-dark">
                                                        Data Out Approved
                                                    </span>
                                                    <span class="text-muted small" data-bs-toggle="tooltip" data-bs-title="Started: xx/xx/xxxx 00:00:00 Ended: xx/xx/xxxx 00:00:00">
                                                        @days days, @hours hours, @minutes minutes
                                                    </span>
                                                </span>
                                            </span>
                                        </li>
                                    </ul>
                                </td>
                                <td scope="col" class="col"></td>
                                <td scope="col" class="col"></td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr class="row">
                                <td scope="col" class="col-2"></td>
                                <td scope="col" class="col">
                                    <h6 class="mb-0">
                                        <span class="badge bg-success rounded-pill d-inline-flex align-items-center pe-3" data-bs-toggle="tooltip" data-bs-title="Completed: @Model.Submission.EndTime">
                                            <i class="fa-solid fa-circle-check fs-6 text-white me-2"></i>
                                            <span class="text-start">
                                                <span class="mb-1">Completed</span>
                                                <span class="font-monospace small d-block">X minutes ago</span>
                                            </span>
                                        </span>
                                    </h6>
                                </td>
                                <td scope="col" class="col">
                                    <h6 class="mb-0">
                                        <span class="badge bg-danger rounded-pill d-inline-flex align-items-center pe-3" data-bs-toggle="tooltip" data-bs-title="Failed: error message">
                                            <i class="fa-solid fa-triangle-exclamation fs-6 text-white me-2"></i>
                                            <span class="text-start">
                                                <span class="mb-1">Failed</span>
                                                <span class="font-monospace small d-block">X minutes ago</span>
                                            </span>
                                        </span>
                                    </h6>
                                </td>
                                <td scope="col" class="col">
                                    <h6 class="mb-0">
                                        <span class="badge bg-primary rounded-pill d-inline-flex align-items-center pe-3">
                                            <i class="fa-solid fa-circle-notch fa-spin fs-6 text-white me-2"></i>
                                            <span class="text-start">
                                                <span class="mb-1">Running</span>
                                                <span class="font-monospace small d-block">X minutes</span>
                                            </span>
                                        </span>
                                    </h6>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    var tesJson = @Html.Raw(Model.Submission.TesJson);
    var jsonViewer = document.getElementById("jsonViewer");
    var showJsonButton = document.getElementById("showJsonButton");
    var jsonVisible = false;
    var test = jsonViewer.textContent = JSON.stringify(tesJson, null, 9);
    showJsonButton.addEventListener("click", function () {
        if (jsonVisible) {
            jsonViewer.style.display = "none";
            jsonVisible = false;
        } else {
            test;
            jsonViewer.style.display = "block";
            jsonVisible = true;
        }
    });
</script>
